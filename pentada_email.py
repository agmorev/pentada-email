import smtplib
from email.message import EmailMessage
import pandas as pd
import time


# Reading list of
df = pd.read_excel('email_list.xlsx', sheet_name=0)

try:
    server = smtplib.SMTP_SSL('mail.pentada-trans.com', 465)
    server.ehlo()
    server.login('office@pentada-trans.com', 'Zur*^29583wsPk')

    # Iterate through the list of emails and send a message to each email
    for index, row in df.iterrows():
        print(row['–ü–æ—à—Ç–∞'])
        try:
            msg = EmailMessage()
            msg.set_content('''
–®–∞–Ω–æ–≤–Ω—ñ —É—á–∞—Å–Ω–∏–∫–∏ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–µ–∫–æ–Ω–æ–º—ñ—á–Ω–æ—ó –¥—ñ—è–ª—å–Ω–æ—Å—Ç—ñ!
–ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –≤—ñ–π–Ω—É —Ç–∞ –Ω–µ–ø—Ä–æ—Å—Ç—ñ –µ–∫–æ–Ω–æ–º—ñ—á–Ω—ñ —Ä–µ–∞–ª—ñ—ó –Ω–∞—à–∞ –∫–æ–º–ø–∞–Ω—ñ—è –ü–¢ "–ü–ï–ù–¢–ê–î–ê –¢–†–ê–ù–°" –ø—Ä–æ–¥–æ–≤–∂—É—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏.
–ú–∏ –≤–∏–¥–∞—î–º–æ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤—ñ –≥–∞—Ä–∞–Ω—Ç—ñ—ó –Ω–∞—à–∏–º –∫–ª—ñ—î–Ω—Ç–∞–º –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ—ó –ª–æ–≥—ñ—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä—ñ–≤.

–¢–æ–º—É —è–∫—â–æ –≤–∏:
‚ùì –Ω–∞–¥–∞—î—Ç–µ –º–∏—Ç–Ω–æ-–±—Ä–æ–∫–µ—Ä—Å—å–∫—ñ –ø–æ—Å–ª—É–≥–∏
‚ùì –ø–µ—Ä–µ–º—ñ—â—É—î—Ç–µ —Ç–æ–≤–∞—Ä–∏ –≤ —Ä–µ–∂–∏–º—ñ —Ç—Ä–∞–Ω–∑–∏—Ç—É
‚ùì —ñ–º–ø–æ—Ä—Ç—É—î—Ç–µ –∞–±–æ –µ–∫—Å–ø–æ—Ä—Ç—É—î—Ç–µ —Ç–æ–≤–∞—Ä–∏
‚ùì –Ω–∞–¥–∞—î—Ç–µ –ø–æ—Å–ª—É–≥–∏ –º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏—Ö –ø–µ—Ä–µ–≤–µ–∑–µ–Ω—å

–ï–∫–æ–Ω–æ–º—Ç–µ —á–∞—Å —Ç–∞ –∫–æ—à—Ç–∏‚ÄºÔ∏è –ö–æ—Ä–∏—Å—Ç–∞–π—Ç–µ—Å—å ‚öôÔ∏è –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–º–∏ ‚öôÔ∏è –º–∏—Ç–Ω–∏–º–∏ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–º–∏ –≥–∞—Ä–∞–Ω—Ç—ñ—è–º–∏‚ÄºÔ∏è

‚ö° –≤–∏–¥–∞—á–∞, –æ–±—ñ–≥ —Ç–∞ –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –≥–∞—Ä–∞–Ω—Ç—ñ–π –≤–∏–∫–ª—é—á–Ω–æ –≤ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–º—É –≤–∏–≥–ª—è–¥—ñ
‚ö° –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–µ–∑–µ—Ä–≤—É–≤–∞—Ç–∏ –∫–æ—à—Ç–∏ –Ω–∞ —Ä–∞—Ö—É–Ω–∫–∞—Ö –º–∏—Ç–Ω–∏—Ü—ñ
‚ö° –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏—Ç—Ä–∞—á–∞—Ç–∏ —á–∞—Å –±—É—Ö–≥–∞–ª—Ç–µ—Ä—ñ–≤ —Ç–∞ –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞
‚ö° –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ª—É—á–∞—Ç–∏ –∫—Ä–µ–¥–∏—Ç–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏ –¥–ª—è –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó –¥—ñ—è–ª—å–Ω–æ—Å—Ç—ñ
‚ö° –ª–∏—à–µ –ø—Ä—è–º–∞ –≤–∑–∞—î–º–æ–¥—ñ—è –≥–∞—Ä–∞–Ω—Ç–∞ –∑ –≤–∞—à–∏–º –º–∏—Ç–Ω–∏–º –±—Ä–æ–∫–µ—Ä–æ–º —Ç–∞ –º–∏—Ç–Ω–∏—Ü–µ—é
‚ö° —Ü—ñ–ª–æ–¥–æ–±–æ–≤–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞
‚ö° –≤–∏–¥–∞—á–∞ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –≥–∞—Ä–∞–Ω—Ç—ñ—ó –∑–∞ 3-5 —Ö–≤–∏–ª–∏–Ω

–î–ª—è —Å—É–±‚Äô—î–∫—Ç—ñ–≤ –≤–∏—Å–æ–∫–æ—ó –¥—ñ–ª–æ–≤–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –ø—ñ–¥ —É—Å—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ –ª–æ–≥—ñ—Å—Ç–∏–∫–∏ —Ç–∞ –æ–±—Å—è–≥–∏ –ø–æ—Å—Ç–∞–≤–æ–∫. –ì–∞—Ä–∞–Ω—Ç—ñ—è ¬´–°—Ç–∞–Ω–¥–∞—Ä—Ç¬ª, ¬´–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞¬ª —Ç–∞ ¬´–õ—ñ–º—ñ—Ç –±–µ–∑ –æ–±–º–µ–∂–µ–Ω—å¬ª.

–î–µ—Ç–∞–ª—ñ: http://bit.ly/3r0wHB2

‚ÄºÔ∏è‚ÄºÔ∏è‚ÄºÔ∏è
–î–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑—Ä—É—á–Ω–æ—ó —Ç–∞ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–º Telegram-–∑–∞—Å—Ç–æ—Å—É–Ω–∫–æ–º PentadaBot https://t.me/pentada_bot (–¥–ª—è –ø–æ—à—É–∫—É –≤ –º–µ—Å–µ–Ω–¥–∂–µ—Ä—ñ @pentada_bot)
–î–µ—Ç–∞–ª—ñ —É –¥–æ–¥–∞—Ç–∫—É –¥–æ —Ü—å–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
‚ÄºÔ∏è‚ÄºÔ∏è‚ÄºÔ∏è

–ó –ø–æ–≤–∞–≥–æ—é
—É–ø–æ–≤–Ω–æ–≤–∞–∂–µ–Ω–∏–π —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–π –≥–∞—Ä–∞–Ω—Ç
–ü–¢ "–ü–ï–ù–¢–ê–î–ê –¢–†–ê–ù–°"

–ù–∞—à—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏:
–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –≥–∞—Ä–∞–Ω—Ç—ñ–π (24/7):
‚òéÔ∏è +38 (067) 447 60 66 (–æ–ø–µ—Ä–∞—Ç–æ—Ä–∏)
üìß zayavka_gd@pentada-trans.com

–Ü–Ω—à—ñ –ø–∏—Ç–∞–Ω–Ω—è:
‚òéÔ∏è +38 (067) 476 97 80
‚òéÔ∏è +38 (067) 476 97 91
‚òéÔ∏è +38 (067) 321 36 65
üìß office@pentada-trans.com

–ù–∞—à–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞:
üíª http://www.pentada-trans.com/

–ú–∏ –≤ —Å–æ—Ü–º–µ—Ä–µ–∂–∞—Ö:
Facebook: https://www.facebook.com/pentadatrans/
Telegram: https://t.me/pentada_bot (–¥–ª—è –ø–æ—à—É–∫—É –≤ –º–µ—Å–µ–Ω–¥–∂–µ—Ä—ñ @pentada_bot)
            ''')
            msg['Subject'] = '–ú–ò–¢–ù–ò–¶–Ø: –º–∏—Ç–Ω—ñ –≥–∞—Ä–∞–Ω—Ç—ñ—ó - –ù–Ü –¥–µ–ø–æ–∑–∏—Ç–∞–º!!!'
            msg['From'] = "office@pentada-trans.com"
            msg['To'] = row['–ü–æ—à—Ç–∞']
            with open("commercial_offer.pdf", 'rb') as fp:
                pdf_data = fp.read()
                ctype = 'application/octet-stream'
                maintype, subtype = ctype.split('/', 1)
                msg.add_attachment(pdf_data, maintype=maintype, subtype=subtype, filename='commercial_offer.pdf')
            server.send_message(msg)
            print(str(index), "–ü–æ—à—Ç—É –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–ª—è {}".format(row['–ü–æ—à—Ç–∞']))
            time.sleep(10)
        except:
            time.sleep(10)
            continue
except Exception as exception:
    print('Something went wrong with connecting to server....{}'.format(exception))
print('All emails sent!')